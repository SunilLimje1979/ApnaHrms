{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Insert Task</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">

<div class="container">
    <h2 class="mb-4">Create New Task</h2>

    <!-- This will display success or error messages from the view -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <!-- This is now a standard Django form -->
    <form method="POST" class="row g-3">
        {% csrf_token %} <!-- REQUIRED for Django POST forms -->

        <div class="col-md-6">
            <label class="form-label">Employee *</label>
            <select class="form-select" name="employee" required>
                <option value="">-- Select Employee --</option>
                {% for emp in employees %}
                    <!-- Assumption: API returns 'employee_id' and 'employee_name' -->
                    <option value="{{ emp.employee_id }}" {% if form_data.employee == emp.employee_id|stringformat:"s" %}selected{% endif %}>
                        {{ emp.employee_name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-6">
            <label class="form-label">Project *</label>
            <select class="form-select" name="project" required>
                <option value="">-- Select Project --</option>
                {% for proj in projects %}
                    <!-- Assumption: API returns 'project_id' and 'project_name' -->
                    <option value="{{ proj.project_id }}" {% if form_data.project == proj.project_id|stringformat:"s" %}selected{% endif %}>
                        {{ proj.project_name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-6">
            <label class="form-label">Task Type *</label>
            <select class="form-select" name="task_type" required>
                <option value="">-- Select Task Type --</option>
                {% for tt in task_types %}
                    <!-- Assumption: API returns 'task_type_id' and 'task_type_name' -->
                    <option value="{{ tt.task_type_id }}" {% if form_data.task_type == tt.task_type_id|stringformat:"s" %}selected{% endif %}>
                        {{ tt.task_type_name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-6">
            <label class="form-label">Date *</label>
            <input type="date" class="form-control" name="date" value="{{ form_data.date }}" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Start Time *</label>
            <input type="time" class="form-control" name="start_time" value="{{ form_data.start_time }}" required>
        </div>

        <!-- ... all other form fields follow the same pattern ... -->
        <div class="col-md-6">
            <label class="form-label">Hours Spent</label>
            <input type="number" step="0.1" class="form-control" name="hours_spent" value="{{ form_data.hours_spent }}">
        </div>

        <div class="col-12">
            <button type="submit" class="btn btn-primary">Create Task</button>
        </div>
    </form>
</div>

</body>
</html>